# 판단(Judgment)

센서를 통해 주변을 인지한 후 어떻게 움직여야 하는지 판단하는 부분

- [경로 계획](./path%20planning/README.md)

## 경로 계획

- 차량이 장애물을 회피하면서 목표지점까지 최적의 경로로 도달하게 하는 기술
    - 안전한 경로 혹은 최적화된 경로를 고려해야함
- 전역(Global)경로계획, 지역(Local)경로계획으로 나뉨


- 전역 경로 계획
    - 지도에 기반하여 경로를 자율적으로 생성
    - 주행 기록을 이용한 전역 경로 생성
        - 직접 주행하여 나온 차량의 위치 좌표를 기록하였다가 그대로 다시 주행하는 방법
        - 기록된 차량의 위치정보 하나하나가 웨이 포인트가 됨

- 지역 경로 계획
    - 지도 정보로부터 나와 있지 않은 예기치 못한 장애물이나 움직이는 장애물에 대해 여러 가지 센서를 이용하여 장애물을 회피하는 경로를 재생성

## 경로 궤적

경로 계획에 따라 차선 변경이나 경로를 따라가기 위한 궤적이 필요하다. 

- 경로 궤적 생성
    - 궤적을 만들 때 가장 쉬운 방법으로는 시작점과 끝점을 이어 조향하는 방법 (1차 함수 궤적)
        - 이 방법은 차선 변경이 시작되는 순간과 완료되는 순간에 큰 각도의 변화를 요구하여 실재로는 힘듦
        - <img src="https://user-images.githubusercontent.com/19484971/188302479-854b8216-6deb-448c-93c3-3418177588a8.png" width=300>
    - 높은 각속도를 피하기 위해서 시작점과 끝점을 잇는 3차 함수 곡선을 생성
        - 1차 함수 궤적보다 훨씬 적은 순각 각도 변화량으로 안정적으로 차량 변경이 가능하도록 한다.
        - <img src="https://user-images.githubusercontent.com/19484971/188302968-0469cdfd-cde3-4ab7-ac7d-1b6353ade3bd.jpg" width=300>
        > < 경로 생성 - 3차 함수 궤적 >
    - 거의.. 유일한? [논문](https://d-nb.info/1108045847/34)을 구글링해서 찾을 수 있었는데 곡률이 있는 도로에서의 차선변경을 고안한 것이라서 너--무 어렵다.

### 경로 추적

경로를 추종하는 방법은 여러가지가 있으나, 대표적으로 `Pure pursuit guidance`가 있다.

- Pure pursuit guidance
    - `path tracking algorithm(경로 추적 알고리즘)` 중 하나
    - 경로 위의 한 점을 원호를 그리며 추적하는 알고리즘
    - 자동차의 기구학과 전방주시거리(Look Ahead Distance)라는 파라미터를 가지고 조향각을 간단하게 계산한다.
    - 실제 자동차 모델(Ackerman geometry)을 단순화 한 Bicycle 모델을 사용
    - 자세한 내용을 [MathWorks](https://kr.mathworks.com/help/robotics/ug/pure-pursuit-controller.html)에서 찾아볼 수 있다.
        - 대충 전방주시거리를 너무 멀리하면 조향이 느려지고 너무 가깝게 하면 과한 조향으로 궤적을 따라가지 못한다는 내용이 있다.

<img src="https://user-images.githubusercontent.com/19484971/188305260-43d53167-2ddd-4693-8700-dab1fd65b501.png" width=600>

`전방주시거리`라는 단어를 설명해주시지 않고 진행하셔서 처음에는 이미지의 변수가 어떤 의미인지 몰랐다;
